% !TEX root=./chap-05.tex
\input{../marco.tex}

\begin{document}

%---------预定设置区----------
\title{\textbf{双杂化密度泛函分子能量与性质计算方法的测评与进展\\第五章草稿}}
\author{祝震予}
\maketitle
\vspace{-10pt}

\tableofcontents

%---------正  文  区----------

\setcounter{section}{4}

\section{高精度基组外推方法在 CCSD(T) 静态极化率计算上的应用}

\subsection{引言}

静态极化率是光学中问题重要的物理量\cite{Marder-Stucky.ACS.1991}；它在化学中，也与 Raman 光谱活性\cite{Wilson-Cross.Dover.1955}、有机反应机理\cite{Xing-Pei.HEP.2005}、以及分子间相互作用\cite{Cohen-Tannoudji-Laloe.Wiley.2020}等问题上有概念上的联系。作为计算化学可以导出的物理量，对静态极化率描述的准确与否，也可以用于判断电子结构近似方法精度与有效性。因此，静态极化率是理论与计算化学都十分关心的重要物理量。

相对于静态极化率的概念是动态极化率。动态极化率 $\alpha(\omega)$ 是在特定频率 $\omega$ 下偶极电场扰动下分子能量变化的表征量，而静态极化率是动态极化率的外场频率外推至零的情况即 $\alpha(0)$。本文中，若不作额外说明，极化率一般指静态极化率。

我们希望对双杂化泛函在静态极化率上的表现作评测与研究；为此，我们需要精确的静态极化率参考值。计算方法的终极目标应当是逼近物理真实的结果，因此参考值应当选取这些真实结果的数值；但现实上，真实结果难以获得。为了确定参考值以评测近似计算化学方法的有效性，可能的方案是以精确的实验数据、或高精度的计算数据替代参考值。

若要通过实验数据构成参考值以测评理论计算结果，一个关键问题与困难是如何准确地联系理论结果与实验环境\cite{Mata-Suhm.ACIE.2017}。对于静态极化率问题，我们认为，通过实验数据确定与获得参考值较为困难。这种困难不仅来源于实验本身的精度，也同时来源于难于排除所有实验环境因素；这些因素包括溶剂效应、非谐效应等各种影响，也因静态偶极矩是动态偶极矩在含频电场下频率外推至零的极限、实验上这种外推的矫正难于实现或精确的数据不足。因此，在目前的研究中，电子结构方法的误差经常会被实验本身的误差、以及实验环境与理论模拟之间的差距所产生的误差的总和所掩盖\cite{Hickey-Rowley.JPCA.2014}。因此，相比起使用实验数值作为参照的方式\cite{Hickey-Rowley.JPCA.2014}，大多数对静态极化率的测评工作都使用高精度理论计算数值作为参考值\cite{Hammond-Xantheas.JCP.2009, Huzak-Deleuze.JCP.2013, Wu-Thakkar.CPL.2015, Kozlowska-Bartkowiak.PCCP.2019, Hait-Head-Gordon.PCCP.2018, Beizaei-Sauer.JPCA.2021}。

若要使用理论参考值作测评工作，有两点非常关键。一者，为了确保评测相对来说公平且完整，数据集应当要足够大、且足够多样，以使得在测评结果在统计上是有意义的。目前的极化率数据集中，较为接近这一目标的有 Hickey 与 Rowley 设计的 46 分子的数据集 (HR46)\cite{Hickey-Rowley.JPCA.2014}，Wu、Kalugina 与 Thakkar 设计的 145 分子数据集 (T145)\cite{Wu-Thakkar.CPL.2015}、以及 Hait 与 Head-Gordon 设计的 132 分子与自由基数据集 (HH132)\cite{Hait-Head-Gordon.PCCP.2018}。二者，作为参考值的电子结构理论计算方法应当足够准确。完全组态相互作用 (Full-CI, Full-\underline{C}onfiguration-\underline{I}nteraction) 结合完备基组 (CBS, \underline{C}omplete \underline{B}asis \underline{S}et) 所给出的结果是最理想的情况，但其计算量巨大，显然是不现实的。HH132 数据集选择使用 CCSD(T)/CBS，即化学中常称为“黄金标准”的 CCSD(T) 方法 (\underline{C}oupled-\underline{C}luster \underline{S}ingles and \underline{D}oubles with perturbative \underline{T}riples)\cite{Cizek-Cizek.Wiley.1969, Raghavachari-Head-Gordon.CPL.1989}、并结合有限基组下的 CBS 外推方法\cite{Nyden-Petersson.JCP.1981, Petersson-Mantzaris.JCP.1988}，给出了极化率的参考值。其中，对于较小的体系，用于 CBS 外推的模式是 aCV[Q5]Z\footnote{在本文中，我们约定作为 Dunning 系列基组的 aV$X$Z 代表 aug-cc-pV$XZ$ 基组、aCV$X$Z 代表 aug-cc-pCV$XZ$ 基组 ($X \in \{\mathrm{D, T, Q, 5}\}$)。同时约定，作为双基组 CBS 外推模式，aV[$XY$]Z 代表基组从 aV$X$Z、aV$Y$Z 外推到 aV$\inf$Z 的基组极限近似。Dunning 系列基组具体的 CBS 外推方式将在\alert{后文定义}。}；对于较大的体系，用于 CBS 外推的模式是 aCV[TQ]Z\cite{Hait-Head-Gordon.PCCP.2018, Hait-Head-Gordon.JCTC.2018}。由于 CBS 外推所用的基组，几乎已是目前计算化学常用的最大基组。对于 CCSD(T) 在电性质计算问题上的准确性，已有文献对此作较为深入的讨论并给出正面的结论\cite{Halkier-Joergensen.JCP.1999, Monten-Deleuze.MP.2011, Hait-Head-Gordon.JCTC.2018}。因此，HH132 数据集的参考值可以认为是可信的。与此同时，HR46 数据集中理论计算给出参考值的模型是 CCSD/aVTZ，而 T145 数据集是 CCSD(T)/aVTZ；CCSD 被认为在计算电性质时精度较低、而 aVTZ 基组也相对较小，因此这两个数据集的理论计算参考值相对于 HH132 数据集，还有进一步提升的空间。

但需要指出，HH132 之所以可以使用 CCSD(T)/aV[TQ]Z 或 CCSD(T)/aV[Q5]Z 的模型给出参考值，是因为该数据集最大的分子仅包含 3 个非氢原子 (包括 \ce{BHF2}, \ce{ClCN}, \ce{CO2}, \ce{CSO}, \ce{FCN}, \ce{FCO}, \ce{HCCCl}, \ce{HCCF}, \ce{HCNH2}, \ce{HCOOH}, \ce{NaCN}, \ce{NOCl}, \ce{O3}, \ce{OCl2}, \ce{OF2}, \ce{SCl2}, \ce{SF2}, \ce{SO2})、或 7 个原子 (包括 \ce{CH3NH2})。而作为对比，HR46 与 T145 数据集的分子相对来说大许多；HR46 最大的体系包含 15 个原子 (toluene 或 \ce{C7H8})；T145 数据集最大的体系包含 14 个原子 (1,4-dithiane 或 \ce{C4H8S2})。HR46 与 T145 数据集中，单个体系含有非氢原子数量最多可达 8 个原子 (例如 6-amino-1H-pyrimidin-2-one 或 \ce{C4H5ON3} 以及 5,5,5-trichloropenta-1,3-diyne 或 \ce{C5HCl3})。因此，HR46 与 T145 数据集难以使用与 HH132 相同的 CCSD(T) 结合大基组 CBS 外推的方式，给出精确地理论计算的参考值。

为了尽可能地推高 HR46 与 T145 数据集的精度，我们考虑到使用组合化学方法。典型的组合化学方法是 G$n$\cite{Pople-Curtiss.JCP.1989, Curtiss-Pople.JCP.1990, Curtiss-Pople.JCP.1991, Curtiss-Pople.JCP.1998, Curtiss-Raghavachari.JCP.2007} 与 W$n$\cite{Martin-Oliveira.JCP.1999, Parthiban-Martin.JCP.2001}；其做法是针对特定的电子结构方法 (如 CCSD(T), CCSD, MP2, HF)，使用对应的、代价上可以承受的基组进行计算，并最终合理地依计算层级对这些方法-基组组合的结果作线性的加减处理，给出更为精确地计算结果。FPA (\underline{F}ocal-\underline{P}oint \underline{A}nalysis) 与组合化学方法有着类似的思想\cite{East-Allen.JCP.1993}。由于能量或极化率张量等性质具有可加性，因此可以将总量上占大头的 HF 方法下大基组计算的结果、MP2 与 HF 方法差减部分在中等基组下计算结果、以及计算复杂度最高但总量上较小的 CCSD(T) 与 MP2 方法差减部分在较小基组下的计算结果作加和。这样的结果一般总是比单纯使用低级别的 HF 结合大基组、或高级别的 CCSD(T) 结合小基组要更为准确。FPA 已经应用于计算化学的各种问题，包括反应生成热\cite{East-Allen.JCP.1993, Nielsen-Schaefer.JCP.1997}、构象能\cite{Csaszar-Schaefer.JCP.1998, Tschumper-Tschumper.JCP.2001, Kahn-Kahn.JCC.2008}、非共价相互作用\cite{Tschumper-Quack.JCP.2002, Jurecka-Hobza.PCCP.2006, Marshall-Sherrill.JCP.2011}、激发能\cite{Bokareva-Godunov.IJQC.2008}、核磁共振屏蔽常数\cite{Sun-Xu.JCP.2013, Wang-Xu.JCP.2018}、以及本工作所关心的静态极化率问题\cite{Huzak-Deleuze.JCP.2013, Monten-Deleuze.MP.2011}。

本工作中，我们将着眼于提升 HR46 与 T145 静态极化率数据集的质量至 CCSD(T)/CBS 的精度。为此，我们首先在可以承受 aCV[Q5]Z 级别计算的小分子体系下，对 HF, MP2, CCSD 与 CCSD(T) 作详细的静态极化率基组收敛性分析。这部分工作的目标是确认对于静态极化率问题，FPA 确实可以给出与 HH132 数据集参考值相似精度的结果，即 FPA 是有效的。随后，我们将 FPA 应用于 HR46 与 T145 数据集的参考值计算上；这些参考值的精度将是 CCSD(T)/aCV[Q5]Z 级别的。我们希望这些高精度的参考值能为未来化学工作者在极化率测评，特别是对密度泛函方法的测评上，提供有效的数据来源。

\subsection{具体方法与实现细节}

\subsubsection{误差测评标准}

对于一个数据量为 $N$ 的数据集的参考值是 $\tilde r = \{ r_n \}$，若近似计算方法的结果是 $\tilde c = \{ c_n \}$、以及作为分母的数据 $\tilde d = \{ d_n \}$，那么数据 $\tilde c$ 的相对方均根误差 (RelRMSD, \underline{Rel}ative \underline{R}oot \underline{M}ean \underline{S}quared \underline{D}eviation) 定义为
\begin{equation}
    \text{RelRMSD} (\tilde c, \tilde r, \tilde d) = \sqrt{\frac{1}{N} \sum_{n = 1}^N \left( \frac{c_n - r_n}{d_n} \right)^2} \times 100\%
\end{equation}
不少情况下，参考值 $\tilde r$ 与分母值 $\tilde d$ 是相同的；此情形下将简记 $\text{RelRMSD} (\tilde c, \tilde r, \tilde d)$ 为 $\text{RelRMSD} (\tilde c, \tilde r)$。一般来说，更低的 RelRMSD 数值，意味着近似计算方法的表现统计上来看越精确。

RelRMSD 误差多大，才认为是可以被接受或容许的范围？首先，本工作的目标是对较大分子体系的极化率作逼近 CBS 外推模型的 CCSD(T)/aCV[Q5]Z 精度的计算；因此，该级别精度在本工作中视为最精确的参考值 $\tilde r$。由于静态极化率的基组极限误差与实验误差通常在 0.5\% 以内\cite{Brakestad-Frediani.JCTC.2020, Rumble-Rumble.CRC.2021}；因此我们认为，对于稍低等级的 FPA 模型或稍小基组下的计算结果，如果其相比于 CCSD(T)/aCV[Q5]Z 的 RelRMSD 误差在 0.5\% 以下，即可认为是足够准确的。

% 关于实验误差，我暂时没能找到 102 版 CRC 常数手册的具体说明。在 2010 年的 90 版 Atomic and Molecular Polarizabilities Table 8 (pdf p. 1648--1649 或 10-200--10-201)，注脚中提到了 0.5% 的误差，但也同时指出了实验条件上是含频率的情况、以及数据年代问题。

\subsubsection{电子结构方法与软件}

本工作的极化率同时使用数值与解析的方式计算；其计算方式定义在\alert{下几小节}作定义。MP2 与 HF 解析极化率是通过 \textsc{PySCF} (commit 3d592b0)\cite{Sun-Chan.WCMS.2018, Sun-Chan.JCP.2020}的扩展程序脚本 \textsc{dh} (ver 0.1.3)\cite{dh-0.1.ajz34} 所实现。正因为该程序可以高效地实现包括双杂化泛函在内的 MP2 型相关能解析极化率，因此本工作中涉及到的所有分子的 MP2 极化率，在引入 RI 近似的前提下，都可以以最精确的 CBS 外推模式 aCV[Q5]Z 实现。对于 CCSD 与 CCSD(T) 方法，本工作使用 \textsc{Q-Chem} (ver 5.1.1)\cite{Shao-Head-Gordon.MP.2015, Kaliman-Krylov.JCC.2017}作数值极化率计算。这部分计算将不引入 RI 近似。本工作不对 post-HF 计算过程引入冻核近似 (FC, \underline{F}rozen \underline{C}ore)。自由基与其他开壳层体系的 HF 自洽场参考态通过自旋非限制性计算给出。

本工作将在\alert{后文}对极化率的数值与解析之间的误差、RI 近似所导致的误差、以及基组误差进行分析。最终汇报的极化率数值中，HF 与 MP2 是通过 RI 近似下解析给出 (这两个方法将分别记为 RI-JK 与 RI-MP2)；CCSD 与 CCSD(T) 的结果将是 RI-MP2 解析极化率、以及更高阶贡献的数值极化率的加和。为更清晰明了地表示极化率数值的构成，本文将使用简记记号；这些记号列于表 \ref{tab.5.1}。该表格的所有记号是针对单个分子或自由基体系的；对于一个数据集合，我们将上标波浪号。举例而言，$\text{RelRMSD} (\Delta \tilde \alpha_{\textsf{(2)}/\text{aVTZ}}, \Delta \tilde \alpha_{\textsf{(2)}/\text{ref}}, \tilde \alpha_{\textsf{CCSD(T)}/\text{ref}})$ 代表 MP2/aVTZ 同性极化率相对于高精度 MP2 参考值的相对方均根误差；该相对误差计算所用的分母，是高精度 CCSD(T) 参考值。

\begin{table}[ht]
    \centering
    \caption{本工作中使用的电子结构方法及其对应极化率的记号\tabnote{a}。}
    \label{tab.5.1}
    \begin{tabular}{ll}
    \hline
    记号 & 说明 \\
    \hline
    num & 数值极化率 \\
    anal & 解析极化率 \\
    conv & 传统电子积分方法，即无 RI 近似的计算方法 \\
    $\alpha$ & 同性极化率 \\
    $\gamma$ & 异性极化率 \\
    $\Delta \alpha_\textsf{(2)}$ & $\alpha^\text{anal}_\textsf{RI-MP2} - \alpha^\text{anal}_\textsf{RI-HF}$ \\
    $\Delta \alpha_\textsf{D}$ & $\alpha^\text{num}_\textsf{CCSD} - \alpha^\text{num}_\textsf{MP2}$ (不引入 RI 近似) \\
    $\Delta \alpha_\textsf{(T)}$ & $\alpha^\text{num}_\textsf{CCSD(T)} - \alpha^\text{num}_\textsf{CCSD}$ (不引入 RI 近似) \\
    $\Delta \alpha_\textsf{D(T)}$ & $\alpha^\text{num}_\textsf{CCSD(T)} - \alpha^\text{num}_\textsf{MP2}$ (不引入 RI 近似) \\
    $\Delta \alpha_\textsf{HF}$ & $\alpha^\text{anal}_\textsf{RI-HF}$ \\
    $\Delta \alpha_\textsf{MP2}$ & $\alpha^\text{anal}_\textsf{RI-MP2} = \alpha_\textsf{HF} + \Delta \alpha_\textsf{(2)}$ \\
    $\alpha_\textsf{CCSD}$ & $\alpha^\text{num}_\textsf{CCSD} - \alpha^\text{num}_\textsf{MP2} + \alpha^\text{anal}_\textsf{RI-MP2} = \alpha_\textsf{HF} + \Delta \alpha_\textsf{(2)} + \Delta \alpha_\textsf{D}$ \\
    $\alpha_\textsf{CCSD(T)}$ & $\alpha^\text{num}_\textsf{CCSD(T)} - \alpha^\text{num}_\textsf{MP2} + \alpha^\text{anal}_\textsf{RI-MP2} = \alpha_\textsf{HF} + \Delta \alpha_\textsf{(2)} + \Delta \alpha_\textsf{D(T)}$ \\
    \hline
    \end{tabular}
  
    \raggedright
    \par\tabnote{a} 上述所有应用于同性极化率 $\alpha$ 的记号，将同样应用于异性极化率 $\gamma$。
\end{table}

\subsubsection{数据集}

本工作着重考察的数据集是 HR46 与 T144。原始的 HR46 数据集\cite{Hickey-Rowley.JPCA.2014}包含 46 个体系 (化合物结构参考附录图 \ref{fig.fig-s1})；其最精确的计算模型是在 MP2/aVTZ 结构下 CCSD/aVTZ 极化率，且该工作中使用了冻核近似。该数据集的特点是
\begin{itemize}[nosep]
    \item 包含的原子种类较多，包括 H, C, N, O, F, S, P, Cl, Br 等元素；
    \item 在 15 个原子以内的限制下，包含大多数常见有机官能团与无机共价键或离域键；
    \item 分子或自由基的选取契合化学反应、污染控制、生物化学与能源化学的需求；
    \item 除了 3 个体系是自由基体系 (\ce{^2NO}, \ce{^3O2}, \ce{^3SO}，上标的数字表示自旋多重度)，其余体系均为非自旋极化的体系 (non-spin-polarized)。
\end{itemize}
在本工作中，HR46 中的所有分子的几何结构经过 RI-MP2/aVTZ 级别作优化，且没有启用冻核近似\alert{盲审通过后将结构的链接链上}。所有极化率的计算也在此几何结构下实现。

原始的 T145 数据集\cite{Wu-Thakkar.CPL.2015}包含 145 个有机体系。该数据集的分子使用 B3LYP/aVTZ 下的优化结构，最精确的极化率计算模型是 CCSD(T)/aVTZ。T145 数据集是 TABS 数据集\cite{Blair-Thakkar.CTC.2014}的子集。TABS 数据集本身是一大类着眼于药物化学、有机化学与生物化学应用的、自旋非极化的数据集。TABS 数据集的分子数量为 1641；一方面该数据集本身数量较大、另一方面为使该数据集用于机器学习，Blair 等人对 TABS 挑选 298 分子作为极化率与分子容量的训练集为 T298 数据集\cite{Blair-Thakkar.CPL.2014}。但由于并非所有 T298 数据集中的分子都可以承受 CCSD(T)/aVTZ 的计算代价，因此 Wu 等人从 T298 选出 145 个较小的分子，以给出极化率参考值更精确的数据集，即 T145 数据集\cite{Wu-Thakkar.CPL.2015}。本工作中，我们选取其中的 144 个分子，并称其为 T144 数据集。相比于 T145 数据集，我们排除了第 1363 号分子 (TABS 分子编号，分子名称为 2,3-dihydro-1,3-oxazole)；这是因为 TABS 数据集提供的分子构型中，1363 号分子与分子式对应的结构相差两个氢原子，即可能存在数据的损坏。T144 数据集的分子构型使用 TABS 原始数据库提供的 B3LYP/aVTZ 几何结构\cite{Blair-Thakkar.CTC.2014} (化合物结构参考附录图 \ref{fig.fig-s2-1})。

关于 HR46 与 T144 数据集化合物名称的变化与勘定，参考附录 \ref{sec.T145-HR46-name-change}。

本工作的一个关键点是基组收敛性评测。为作有效的评测，测评的体系应可承受高精度大基组 (如 CCSD(T)/aCV5Z 级别模型) 的计算量与资源需求。在 HR46 与 T144 数据集中，14 个体系 (\ce{Cl2}, \ce{CO}, \ce{CO2}, \ce{H2O}, \ce{N2}, \ce{NH3}, \ce{^3O2}, \ce{PH3}, \ce{SH2}, \ce{SiH4}, \ce{^3SO}, \ce{SO2}, \ce{FCN}, \ce{HCHS}) 可以承受大计算量的计算。这 14 个数据也同样出现在 HH132 数据集中。在测评基组收敛性问题时，这 14 个小体系的分子构型将采用 NIST 计算化学数据库中实验的数据\cite{NIST.CCCBDB}；这些构型也同样为 HH132 数据集所采用。

\subsubsection{基组与 RI 近似}

在本工作中，我们将使用 Dunning 系列基组 aV$X$Z 与 aCV$X$Z ($X = \mathrm{D, T, Q, 5}$)\cite{Dunning-Dunning.JCP.1989, Kendall-Harrison.JCP.1992, Woon-Dunning.JCP.1993, Peterson-Dunning.JCP.1994, Wilson-Dunning.JMST.1996, VanMourik-Dunning.MP.1999, Wilson-Dunning.JCP.1999, VanMourik-Dunning.IJQC.2000, Peterson-Dunning.JCP.2002, Hill-Peterson.JCP.2010}。H 与 Br 原子并不出现在 aCV$X$Z 系列基组中；对于这两个原子作 aCV$X$Z 级别计算时，将不加说明地替换为对应的 aV$X$Z 基组。RI 近似可以大幅减少 MP2 的计算耗时，并且不会产生严重的误差损耗，是性价比相当高的技术手段\cite{Vahtras-Feyereisen.CPL.1993}。本工作的解析极化率计算中，我们对 Weigend 算法实现的 RI-JK\cite{Weigend-Weigend.PCCP.2002} 与 RI-MP2 相关贡献\cite{Weigend-Haettig.JCP.2002}计算均使用等比辅助基 (ETB, \underline{E}ven-\underline{T}empered auxiliary \underline{B}asis set)\cite{Stoychev-Neese.JCTC.2017}；等比参数设为 \textsc{PySCF} 程序默认的 $\beta = 2$。由于基于 \textsc{PySCF} 的扩展程序 \textsc{dh} 的高效率实现、以及对大基组下内存的合理控制，使得本工作中所有体系都可以在 MP2/aCV5Z 下完成计算。作为自洽场的 RI-JK 方法的能量收敛精度为 $10^{-10}$ Hartree。

\subsubsection{数值极化率}

在\alert{第三章的讨论}中，我们已经了解极化率是对外电场强度的二阶梯度；依外电场 $\pmb{\mathcal{E}}$ 在三个空间方向取向的大小 $(\mathcal{E}_x, \mathcal{E}_y, \mathcal{E}_z)$，极化率张量 $\bm{\alpha}$ 是 $3 \times 3$ 的对称矩阵：
\begin{equation}
    \alpha_{ts} = - \frac{\partial^2 E}{\partial \mathcal{E}_t \partial \mathcal{E}_s} \quad t, s \in \{ x, y, z \}
\end{equation}
作为物理上可观测的量，本工作着重测评同性极化率 $\alpha$\footnote{通过标量记号表示，用以区分作为矩阵的极化率张量 $\bm{\alpha}$。}和异性极化率 $\gamma$：
\begin{align}
    \alpha &= \frac{1}{3} \left( \alpha_{xx} + \alpha_{yy} + \alpha_zz \right) = \mathrm{tr} (\bm{\alpha}) \\
    \gamma &= \frac{1}{\sqrt{2}} \left( (\alpha_{xx} - \alpha_{yy})^2 + (\alpha_{yy} - \alpha_{zz})^2 + (\alpha_{zz} - \alpha_{xx})^2 + 6 (\alpha_{xy}^2 + \alpha_{yz}^2 + \alpha_{zx}^2) \right)^{1/2}
\end{align}
对于数值极化率的求取过程，对角元部分 $\alpha_{tt}$ ($t \in \{ x, y, z \}$) 通过线性的三点格式作数值导数给出：
\begin{equation}
    \label{eq.pol-findiff-alpha-def}
    \alpha_{tt} = - \frac{\partial^2 E}{\partial \mathcal{E}_t^2} = - \frac{1}{h^2} \left( E(- \bm{h}_t) - 2 E(\bm{0}) + E(\bm{h}_t) \right) + o(h^2)
\end{equation}
而非对角元部分 $\alpha_{ts}$ ($t, s \in \{ x, y, z \}, \, t \neq s$) 则通过平面上的三点格式作数值导数给出：
\begin{equation}
    \label{eq.pol-findiff-gamma-def}
    \alpha_{ts} = - \frac{\partial^2 E}{\partial \mathcal{E}_t \partial \mathcal{E}_s} = - \frac{1}{4h^2} \left( E(- \bm{h}_t - \bm{h}_s) - E(- \bm{h}_t + \bm{h}_s) - E(\bm{h}_t - \bm{h}_s) + E(\bm{h}_t + \bm{h}_s) \right) + o(h^2)
\end{equation}
其中，$\bm{h}_t, \bm{h}_s$ 分别是 $t, s$ 方向外加微扰电场强度矢量：
\begin{equation*}
    \bm{h}_x = (h, 0, 0)^\dagger, \quad \bm{h}_y = (0, h, 0)^\dagger, \quad \bm{h}_z = (0, 0, h)^\dagger
\end{equation*}
标量 $h$ 是微扰电场的强度；在本工作的数值差分计算中，我们对所有体系均使用 $h = 0.004$ au。关于使用该外加微扰强度的合理性，我们在附录的 \ref{sec.5.s9} 小节中作讨论。

数值梯度计算大多数情形使用 \textsc{Q-Chem} 程序。自洽场的收敛判据 (\texttt{SCF\_CONVERGENCE} 关键词) 设为 $10^{-11}$ au，而 CCSD 能量与振幅收敛判据 (\texttt{CC\_E\_CONV} 与 \texttt{CC\_T\_CONV}) 分别设为 $10^{-10}$ au 与 $10^{-7}$ au。作为特例，对于 \ce{^2NO} 分子，其数值梯度是通过 \textsc{PySCF} 在限制分子对称性的不可约表示而实现；其自洽场与 CCSD 收敛判据与 \textsc{Q-Chem} 设置相同。由于我们在以 aCV5Z 基组计算 \ce{SO2} 分子时遇到收敛困难，因此该情形下我们分别降低 \textsc{Q-Chem} 的收敛判据 \texttt{SCF\_CONVERGENCE}, \texttt{CC\_E\_CONV}, \texttt{CC\_T\_CONV} 为 $10^{-10}$ au, $10^{-9}$ au, $10^{-6}$ au。

\subsubsection{CBS 外推}

CBS 外推方法通常被认为在计算资源不足、以及有限基组不充分大时，可以有效地提升计算精度以更接近完备基组极限的手段。关于具体的 CBS 外推方法与策略，目前已有许多文献对此作说明与讨论\cite{Nyden-Petersson.JCP.1981, Petersson-Mantzaris.JCP.1988, Dunning-Dunning.JCP.1989, Peterson-Dunning.JCP.1994, Jensen-Jensen.TCA.2005, Karton-Martin.TCA.2006, Truhlar-Truhlar.CPL.1998, Klopper-Kutzelnigg.JMST.1986, Kutzelnigg-Morgan.JCP.1992, Martin-Martin.CPL.1996, Helgaker-Noga.JCP.1997, Halkier-Wilson.CPL.1998, Halkier-Olsen.CPL.1999}。HH132 数据集的原始工作使用的 CBS 策略是三次外推式\cite{Hait-Head-Gordon.PCCP.2018}
\begin{equation}
    \label{eq.cbs.zeta3}
    \alpha(\zeta) = \alpha(\text{CBS}) + A \zeta^{-3}
\end{equation}
其中，$\zeta$ 是基组的基数 (cardinal number)。对于 Dunning 基组，aV$X$Z 或 aCV$X$Z 的 $X = \mathrm{D, T, Q, 5}$ 分别对应的基数是 $\zeta = 2, 3, 4, 5$。对于 CBS 外推模型 aCV[TQ]Z，其相对于 aCV5Z 的误差，对于偶极矩大约是 $\sim 0.2\%$\cite{Hait-Head-Gordon.JCTC.2018, Halkier-Joergensen.JCP.1999}，对于极化率大约是 $\sim 0.1\%$\cite{Hait-Head-Gordon.PCCP.2018}；这意味着三次外推式 (\ref{eq.cbs.zeta3}) 对电性质的计算是有效的。在本工作中，对极化率的计算将沿用该 CBS 外推策略。对于 HR46 与 T144 全部分子的 MP2 极化率的计算，我们都使用 aCV[Q5]Z 作为参考值；而对于 CCSD 与 CCSD(T) 计算，则会依照分子体系的大小而给予相适应的 CBS 外推模型 aV[$XY$]Z ($[XY] = \mathrm{[Q5], [TQ], [DT]}$) 计算。

\subsubsection{FPA 策略}

在有限的计算资源内，若高等级方法难以直接计算得到，那么 FPA 方法会是一种尽可能逼近高等级计算方法结果、但使用相对较小计算资源的手段。在本工作中，我们的目标是给出 CCSD(T)/CBS 的参考值，其中的 CBS 是通过高精度的 aCV[Q5]Z 外推近似得到。考虑到不是所有体系都可以承受如此大的计算量，因此对极化率作三部分拆分：以同向极化率为例，CCSD(T) 极化率 $\alpha_\textsf{CCSD(T)}$ 拆分出这三部分是 HF 部分 $\alpha_\textsf{HF}$、MP2 相关贡献部分 $\Delta \alpha_\textsf{(2)}$、以及更高阶贡献部分 $\Delta \alpha_\textsf{D(T)}$：
\begin{align}
    \alpha_{\textsf{CCSD(T)}/\text{CBS}} &= \alpha_{\textsf{HF}/\text{CBS}} + \Delta \alpha_{\textsf{(2)}/\text{CBS}} + \Delta \alpha_{\textsf{D(T)}/\text{CBS}} \notag\\
    &\simeq \alpha_{\textsf{HF}/\text{LB}} + \Delta \alpha_{\textsf{(2)}/\text{CBS}} + \Delta \alpha_{\textsf{D(T)}/\text{CBS}'} \notag\\
    &\simeq \alpha_{\textsf{HF}/\text{LB}} + \Delta \alpha_{\textsf{(2)}/\text{CBS}} + \Delta \alpha_{\textsf{D(T)}/\text{SB}}
\end{align}
上式下标的 LB 是指大基组 (\underline{L}arge \underline{B}asis set)、SB 是指小基组 (\underline{S}mall \underline{B}asis set)。我们的工作对 HF 方法直接采用 $\text{LB} = \text{aCV5Z}$ 基组。对于 MP2 的相关贡献部分 $\Delta \alpha_{\textsf{(2)}/\text{CBS}}$，我们始终选择使用最高精度的 aCV[Q5]Z 外推模型。更高阶贡献部分 $\Delta \alpha_{\textsf{D(T)}/\text{CBS}'}$ 是指对高精度 CBS 外推 $\Delta \alpha_{\textsf{D(T)}/\text{CBS}}$ 的近似；目前针对 $\Delta \alpha_{\textsf{D(T)}/\text{CBS}'}$ 的计算基组级别取决于体系的大小。若对 $\Delta \alpha_{\textsf{D(T)}/\text{CBS}'}$ 的计算使用基组 aV[$XY$]Z 与 aCV[$XY$]Z，那么我们称该 FPA 策略为 FPA-aV[$XY$]Z。同样地，若对 $\Delta \alpha_{\textsf{D(T)}/\text{LB}}$ 的计算使用基组 aV[$X$]Z 与 aCV[$X$]Z ($X < 5$)，那么我们称该 FPA 策略为 FPA-aV[$X$]Z。

\begin{figure}[ht]
    \centering
    \caption{本工作所使用的 FPA 模型。该图以 FPA-aV[TQ]Z 作为例子；其中 $\alpha_{\textsf{HF}/\text{LB}}$ 以 aCV5Z 计算所得、$\Delta \alpha_{\textsf{(2)}/\text{CBS}}$ 以 aCV[Q5]Z 计算所得、$\Delta \alpha_{\textsf{D(T)}/\text{CBS}'}$ 以 aV[TQ]Z 计算所得。}
    \label{fig.fig-1}
    \includegraphics[width=0.9\textwidth]{assets/fig-1.png}
\end{figure}

以 FPA-aV[TQ]Z 作为例子，使用 FPA 策略的合理性通过图 \ref{fig.fig-1} 展示。HF 方法的结果占真实结果的绝对大头；但为正确描述物性，高质量的相关效应描述也是重要的。由于 HF 方法一般来说依基组基数 $\zeta$ 的收敛速度相当快\cite{Jensen-Jensen.TCA.2005, Karton-Martin.TCA.2006}，因此许多 CBS 策略、包括 HH132 数据集的参考值，都对 HF 方法直接使用计算量上最大可承受的基组。而对于相关效应，则依基组基数 $\zeta$ 的增大，收敛速度相对缓慢。大多数情况下，MP2 占据相关效应的主要部分；因此，对 MP2 的大基组精确描述也非常重要。但对于更高阶的相关效应，一方面其绝对数值已然较小，另一方面数值对基组基数 $\zeta$ 的敏感性较小、或相对于 MP2 相关效应的收敛速度更快。对于后一方面所述的现象，目前已经在核磁屏蔽常数的计算\cite{Sun-Xu.JCP.2013, Wang-Xu.JCP.2018, Gregusova-Bartlett.JCTC.2010}、能量计算\cite{Truhlar-Truhlar.CPL.1998}等诸多情形下有所验证。因此，我们也会期望在极化率问题中，对于 CCSD(T) 相对于 MP2 之间的高级相关效应，使用较低等级基组或 CBS 外推方法，也可以提供一个合理的对高等级 CBS 外推方法的近似。本工作的其中一个重点，即是验证这个猜想的合理性。

\subsection{结论与讨论}

\subsubsection{RI 误差与数值差分误差}

在本工作中，HF 与 MP2 的极化率是通过解析梯度给出，但引入了 RI 近似；CCSD 与 CCSD(T) 尽管未使用 RI 近似，但引入了数值差分误差。注意到表 \ref{tab.5.1} 中，将要汇报的 $\alpha_\textsf{CCSD(T)}$ 参考值是由 $\alpha^\text{anal}_\textsf{RI-MP2} + \Delta \alpha^\text{num}_\textsf{D(T)}$ 两部分构成；这两部分分别包含 RI 近似误差与数值差分误差。为了估计这部分误差的大小，我们考察了 HF 与 MP2 方法在 aVTZ 基组下、包含 RI 近似与不使用 RI 近似的同性极化率的结果。

我们看到，解析 RI-HF 与数值 HF 方法同性极化率之间相对方均根误差 $\text{RelRMSD} (\tilde \alpha_\textsf{RI-HF}^\text{anal}, \tilde \alpha^\text{num}_\textsf{HF})$，对于 HR46 与 T144 数据集，分别是 0.018\% 与 0.022\%。解析 RI-MP2 与数值 MP2 方法相关能贡献部分的方均根误差 $\text{RelRMSD} (\Delta \tilde \alpha^\text{anal}_\textsf{RI-(2)}, \Delta \tilde \alpha^\text{num}_\textsf{(2)}, \tilde \alpha^\text{num}_\textsf{MP2})$，对于两个数据集的误差均小于 0.01\%。这些误差都远远小于实验误差标准的 0.5\%，因此我们认为 RI 近似与数值差分误差对总的同性极化率 $\alpha_\textsf{CCSD(T)}$ 计算结果影响相当小，以至于可以忽略。我们猜测该结论对异性极化率 $\gamma_\textsf{CCSD(T)}$ 也同样适用。

我们还看到，对于相关贡献部分，自洽场收敛条件会对数值差分误差有一定影响。相关的数据与结论列于附录的 \ref{sec.5.s9} 小节。

\subsubsection{小体系的同性极化率基组收敛性}

在这两小节中，我们将对 14 个小体系 (\ce{Cl2}, \ce{CO}, \ce{CO2}, \ce{H2O}, \ce{N2}, \ce{NH3}, \ce{^3O2}, \ce{PH3}, \ce{SH2}, \ce{SiH4}, \ce{^3SO}, \ce{SO2}, \ce{FCN}, \ce{HCHS}) 作系统的基组收敛性分析，并基于此确定用于计算同性极化率的、高效的 FPA 模型。在该分析中，参考值由 CCSD(T)/CBS 计算所得：
\begin{equation*}
    \alpha_{\textsf{CCSD(T)}/\text{CBS}} = \alpha_{\textsf{HF}/\text{aCV5Z}} + \Delta \alpha_{\textsf{(2)}/\text{aCV[Q5]Z}} + \Delta \alpha_{\textsf{D(T)}/\text{aCV[Q5]Z}}
\end{equation*}
该参考值也对应了 HH132 数据集中最精确的 CBS 外推模型。详细的对 Dunning 系列基组的误差分析展示于表 \ref{tab.5.2}。

\begin{table}[ht]
    \centering
    \caption{14 小体系同性极化率的相对方均根误差\tabnote{a}。}
    \label{tab.5.2}
    \begin{tabular}{cld{2.4}d{2.4}d{2.4}d{2.4}}
        \hline
          &              & \multicolumn{4}{c}{RelRMSD   error / \%}                \\ \cline{3-6}
    Level & \multicolumn{1}{c}{Basis set}    &
      \multicolumn{1}{c}{$\tilde \alpha_\textsf{HF}$\tabnote{b}}  &
      \multicolumn{1}{c}{$\Delta \tilde \alpha_\textsf{(2)}$\tabnote{c}}  &
      \multicolumn{1}{c}{$\Delta \tilde \alpha_\textsf{D}$\tabnote{c}} &
      \multicolumn{1}{c}{$\Delta \tilde \alpha_\textsf{D(T)}$\tabnote{c}}     \\ \hline
    2-$\zeta$ & aVDZ         & 3.385       & 0.853       & 1.113      & 0.787          \\
              & aCVDZ        & 3.376       & 0.799       & 1.053      & 0.748          \\ \hdashline
    3-$\zeta$ & aVTZ         & 0.703       & 0.516       & 0.406      & 0.297          \\
              & aCVTZ        & 0.671       & 0.385       & 0.339      & 0.270          \\
              & aV[DT]Z      &             & 0.535       & 0.155      & \textbf{0}.\textbf{144} \\ \hdashline
              & aCV[DT]Z     &             & 0.373       & 0.156\tabnote{d}     & 0.178\tabnote{d}         \\
    4-$\zeta$ & aVQZ         & 0.097       & 0.403       & 0.168      & 0.124          \\
              & aCVQZ        & 0.084       & 0.244       & 0.12       & 0.101          \\
              & aV[TQ]Z      &             & 0.359       & 0.111      & \textbf{0}.\textbf{086} \\
              & aCV[TQ]Z     &             & 0.179       & 0.131\tabnote{e}     & 0.096\tabnote{e}         \\ \hdashline
    5-$\zeta$ & aV5Z         & 0.024       & 0.233       & 0.082      & 0.065          \\
              & aCV5Z        & \multicolumn{1}{c}{\textbf{0}\tabnote{f}} & 0.125       & 0.061      & 0.052          \\
              & aV[Q5]Z      &             & 0.071       & 0.013      & \textbf{0}.\textbf{017} \\
              & aCV[Q5]Z     &             & \multicolumn{1}{c}{\textbf{0}\tabnote{f}} & \multicolumn{1}{c}{0\tabnote{f}}         & \multicolumn{1}{c}{0\tabnote{f}}             \\
    \hline
    \end{tabular}

    \raggedright
    \par\tabnote{a} 粗体的数字表示除参考值模型 FPA-aCV[Q5]Z 外，目前为止最佳的 FPA 模型；即依 3,4,5-$\zeta$ 分类下 FPA-aV[DT]Z、FPA-aV[TQ]Z 与 FPA-aV[Q5]Z。
    \par\tabnote{b} HF 同性极化率相对方均根误差为 $\text{RelRMSD} (\tilde \alpha_{\textsf{HF}/\text{basis}}, \tilde \alpha_{\textsf{HF}/\text{ref}}, \tilde \alpha_{\textsf{CCSD(T)}/\text{ref}})$。其中，$\tilde \alpha_{\textsf{HF}/\text{ref}}$ 指代的是 $\tilde \alpha_{\textsf{HF}/\text{aCV5Z}}$，$\tilde \alpha_{\textsf{CCSD(T)}/\text{ref}}$ 指代的时作为参考值的 $\alpha_{\textsf{CCSD(T)}/\text{CBS}}$。
    \par\tabnote{c} 相关能贡献的同性极化率相对方均根误差为 $\text{RelRMSD} (\Delta \tilde \alpha_{\textsf{corr}/\text{basis}}, \Delta \tilde \alpha_{\textsf{corr}/\text{ref}}, \tilde \alpha_{\textsf{CCSD(T)}/\text{ref}})$。其中，$\Delta \tilde \alpha_{\textsf{corr}}$ 可以是指 $\Delta \tilde \alpha_{\textsf{(2)}}$、$\Delta \tilde \alpha_{\textsf{D}}$ 或 $\Delta \tilde \alpha_{\textsf{D(T)}}$；而 $\Delta \tilde \alpha_{\textsf{corr}/\text{ref}}$ 指代的是 $\Delta \tilde \alpha_{\textsf{corr}/\text{aCV[Q5]Z}}$。
    \par\tabnote{d} 在排除 \ce{^3O2} 与 \ce{^3SO} 体系后，$\Delta \tilde \alpha_\textsf{D}$ 与 $\Delta \tilde \alpha_\textsf{D(T)}$ 的 RelRMSD 误差分别降至 0.126\% 与 0.136\%。对于这两个体系的基组收敛分析，将在附录 \ref{sec.5.s4} 小节展开。
    \par\tabnote{e} 在排除 \ce{Cl2} 体系后，$\Delta \tilde \alpha_\textsf{D}$ 与 $\Delta \tilde \alpha_\textsf{D(T)}$ 的 RelRMSD 误差分别降至 0.089\% 与 0.069\%。对于该体系的基组收敛分析，将在附录 \ref{sec.5.s4} 小节展开。
    \par\tabnote{f} 这些数值依据参考值的选取方式，从定义上是零。
\end{table}

\newpage

\subsection{附录}

\subsubsection{HR46 与 T144 数据集分子结构}

\begin{figure}[H]
    \centering
    \caption{HR46 数据集分子结构。}
    \label{fig.fig-s1}
    \includegraphics[width=0.85\textwidth]{assets/fig-s1.pdf}
\end{figure}

\begin{figure}[H]
    \centering
    \caption{T144 数据集分子结构。}
    \label{fig.fig-s2-1}
    \includegraphics[width=0.85\textwidth]{assets/fig-s2-1.pdf}
\end{figure}

\setcounter{figure}{\value{figure} - 1}

\begin{figure}[H]
    \centering
    \caption{(续图)}
    \label{fig.fig-s2-2}
    \includegraphics[width=0.85\textwidth]{assets/fig-s2-2.pdf}
\end{figure}

\setcounter{figure}{\value{figure} - 1}

\begin{figure}[H]
    \centering
    \caption{(续图)}
    \label{fig.fig-s2-3}
    \includegraphics[width=0.85\textwidth]{assets/fig-s2-3.pdf}
\end{figure}

\setcounter{figure}{\value{figure} - 1}

\begin{figure}[H]
    \centering
    \caption{(续图)}
    \label{fig.fig-s2-4}
    \includegraphics[width=0.85\textwidth]{assets/fig-s2-4.pdf}
\end{figure}

\setcounter{figure}{\value{figure} - 1}

\begin{figure}[H]
    \centering
    \caption{(续图)}
    \label{fig.fig-s2-5}
    \includegraphics[width=0.85\textwidth]{assets/fig-s2-5.pdf}
\end{figure}

\newpage

\subsubsection{体系名称的更改}
\label{sec.T145-HR46-name-change}

本工作会对原先 T144 与 HR46 数据集的化合物名称作一定更改。我们尽量依照 IUPAC 推荐命名规则 (PIN, \underline{P}referred \underline{I}UPAC \underline{N}ame) 进行命名\cite{Favre-Powell.RSC.2013}。举例而言，“acetone”(丙酮) 将被命名为“propane-2-one”(丙-2-酮)。这类名称更改是平凡的。

HR46 原文献\cite{Hickey-Rowley.JPCA.2014}中，正文中名称为“thymine”的分子应命名为“cytosine”(胞嘧啶，或 PIN 命名 6-amino-1\textit{H}-pyrimidin-2-one)。其补充信息中的命名是正确的。

T144 数据集中，我们依据 TABS 数据库所提供的分子坐标文件，对下述 4 个分子的名称作勘定，并示于表 \ref{tab.T144-name-errata}。

\begin{table}[H]
    \centering
    \caption{T144 数据集名称勘定。}
    \label{tab.T144-name-errata}
    \begin{tabular}{lll}
    \hline
    ID   & Original   Name                & Updated   Name                    \\ \hline
    0129 & carbonochloridodithioic   acid & methyl   carbonochloridodithioate \\
    0399 & hydroxymethylperoxide          & hydroperoxymethanol               \\
    1193 & 2-bromoethanone                & 2-bromoethen-1-one                \\
    1630 & 5-methyl-2\textit{H}-tetrazole          & 5-methyl-1\textit{H}-tetrazole             \\ \hline
    \end{tabular}
\end{table}

\subsubsection{对有限差分误差的分析}
\label{sec.5.s9}

对同性极化率 $\alpha$ 所作的因有限差分而导致误差的分析列于表 \ref{tab.5.s8}。作为参照的数值是解析梯度所计算得到的极化率。我们假定对异性极化率 $\gamma$ 应有类似的结论。在该分析中，我们将使用两种自洽场收敛判据。需要指出，解析梯度极化率的精度也受机器精度、自洽场收敛精度与 CP-HF 方程收敛精度等要素影响；但在这段分析中，我们假定这些影响要素可以忽略不计。

\begin{table}[ht]
    \centering
    \caption{HR45 数据集同性极化率因数值导数而起的相对方均差 (RelRMSD)\tabnote{a}。}
    \label{tab.5.s8}
    \begin{tabular}{ccccccc}
    \hline
    & \multicolumn{2}{c}{$\alpha_\textsf{MP2}$ / \%\tabnote{b}} & \multicolumn{2}{l}{$\alpha_\textsf{HF}$ / \%\tabnote{c}} & \multicolumn{2}{l}{$\Delta \alpha_\textsf{(2)}$ / \%\tabnote{d}} \\
    Interval $h$ / au & loose\tabnote{e}         & tight\tabnote{f}        & loose\tabnote{e}        & tight\tabnote{f}        & loose\tabnote{e}         & tight\tabnote{f}         \\
    \hline
    0.0005            & 1.625          & 0.000         & 0.000         & 0.000         & 1.625          & 0.000          \\
    0.0010            & 0.395          & 0.002         & 0.001         & 0.001         & 0.395          & 0.001          \\
    0.0020            & 0.046          & 0.006         & 0.005         & 0.005         & 0.046          & 0.002          \\
    0.0040            & 0.031          & 0.025         & 0.019         & 0.019         & 0.020          & 0.008          \\
    0.0080            & 0.101          & 0.101         & 0.075         & 0.075         & 0.033          & 0.033          \\
    0.0160            & 0.415          & 0.415         & 0.309         & 0.309         & 0.138          & 0.138          \\
    \hline
    \end{tabular}

    \raggedright
    \par\tabnote{a} 该表格数据是通过 \textsc{PySCF} 结合扩展程序 \textsc{dh}，以 aVTZ 级别基组计算，对 HR45 数据集 (除去了 \ce{^2NO} 分子的 HR46 数据集)，在不同的自洽场收敛条件、以及不同的有限差分外场强度 $h$ 下所给出 (其意义在式 (\ref{eq.pol-findiff-alpha-def}, \ref{eq.pol-findiff-gamma-def}) 给出)。所有计算都使用 RI 近似，且 RI 辅助基选用 \textsc{PySCF} 默认的 ETB 给出。
    \par\tabnote{b} $\alpha_\textsf{MP2}$ 的相对方均根误差是指 $\text{RelRMSD} (\tilde \alpha^\text{num}_\textsf{RI-MP2}, \tilde \alpha^\text{anal}_\textsf{RI-MP2})$。
    \par\tabnote{c} $\alpha_\textsf{HF}$ 的相对方均根误差是指 $\text{RelRMSD} (\tilde \alpha^\text{num}_\textsf{RI-JK}, \tilde \alpha^\text{anal}_\textsf{RI-JK})$。
    \par\tabnote{d} $\Delta \alpha_\textsf{(2)}$ 的相对方均根误差是指 $\text{RelRMSD} (\Delta \tilde \alpha^\text{num}_\textsf{RI-(2)}, \Delta \tilde \alpha^\text{anal}_\textsf{RI-(2)}, \tilde \alpha^\text{anal}_\textsf{RI-MP2})$。
    \par\tabnote{e} 宽松的 (loose) 收敛条件是指，在 \textsc{PySCF} 的两次相邻的自洽场迭代过程中，当达到能量阈值 (\texttt{conv\_tol}) $10^{-10}$ au 且达到轨道梯度阈值 (\texttt{conv\_tol\_grad}) $10^{-5}$ 时，则判定自洽场收敛。该表格所有数据都成功在 50 次自洽场迭代中以宽松条件收敛。该收敛条件亦用于正文中的所有解析极化率计算过程。
    \par\tabnote{f} 严格的 (tight) 收敛条件是指，在 \textsc{PySCF} 的两次相邻的自洽场迭代过程中，当达到能量阈值 (\texttt{conv\_tol}) $10^{-13}$ au 且达到轨道梯度阈值 (\texttt{conv\_tol\_grad}) $10^{-10}$ 时、或自洽场已经进行了 50 次迭代，则不论是否真正地收敛而停止自洽场迭代。
\end{table}

我们看到对于 $\alpha_\textsf{HF}$，数值与解析导数之间的误差近乎完全来自于外加偶极电场强度 $h$；但对于 MP2 的相关贡献部分 $\Delta \alpha_\textsf{(2)}$，若自洽场没有以严格的判标收敛，那么极化率的结果将会有比较显著的误差。

对于任何计算，特别是 post-SCF 方法的分子性质计算，自洽场的收敛当然是越精确、收敛判标越严格越好。但在现实的计算资源内、以及考虑到计算成本与精度需求的平衡，过分严格的自洽场并不一定划算、也不一定可以真的实现。考虑到我们对本工作的极化率参考值误差的预期是 0.5\% 以内；一方面，我们不希望在方法和基组误差之外，还有很大的有限差分误差；但另一方面，我们注意到在外加电场强度在 $h = 0.0040 \, \text{au}$ 时，在相对宽松的 (\textsc{PySCF} 默认的) 自洽场收敛判据下，$\alpha_\textsf{MP2}$ 的数值极化率与理论极化率的相对方均根误差仅有 0.031\%。据此我们推测，对于其他后自洽场方法 (譬如 CCSD(T))，对同向极化率 $\alpha$ 与异向极化率 $\gamma$，在自洽场收敛判据不低于 $10^{-10}$ au、对于更大基组且未引入 RI 近似的情形、以及对于其他数据集，若使用外加电场强度 $h = 0.0040 \, \text{au}$ 作数值差分，那么因差分而引入的误差大约在 0.05\% 的级别。这种程度的误差相比于实验精度的 0.5\% 误差，是完全可以忽略的。

\subsubsection{$\Delta \alpha_\textsf{D(T)}$ 对体系 \ce{^3O2}, \ce{^3SO}, \ce{Cl2} 计算结果的基组收敛趋势}
\label{sec.5.s4}

这里的讨论是对正文表 \ref{tab.5.2} 中异常数据的分析。需要注意本小节与下一小节对基组收敛性分析图片的纵坐标是对称对数坐标：当误差大于 0.1\% 或小于 -0.1\% 时选用对数坐标；当误差介于两者之间时选用线性坐标。对于特定基组，其相对误差是由下式所计算：
\begin{equation*}
    \frac{\Delta \alpha_{\textsf{D(T)} / \text{basis}} - \Delta \alpha_{\text{aCV[Q5]Z}}}{\alpha_{\textsf{CCSD(T)} / \text{ref}}}
\end{equation*}
图片中的叉形散点是 CBS 外推过程；图中的 CBS 外推将绘制在比原先基组基数大 1 的位置上；即 [DT]Z 被看作是 QZ (4-$\zeta$) 级别、即 [TQ]Z 被看作是 5Z (5-$\zeta$) 级别、即 [Q5]Z 被看作是 6Z (6-$\zeta$) 级别。相对误差介于 -0.5\% 与 0.5\% 之间的部分以浅绿色背景展示。

\textbf{\ce{^3O2} 的基组收敛性。}收敛情况如图 \ref{fig.O2-iso} 所示。对于该体系，$\Delta \alpha_\textsf{D(T)}$ 在 aCVDZ 上的表现比 aVDZ 要更好、但 aCVTZ 上的表现比 aVTZ 要差。因此，尽管 aCV[DT]Z 作为 CBS 外推，确实其效果比 aCVTZ 要好；但外推的进步相比于 aV[DT]Z 与 aVTZ 之间的差距，则要小许多。因此会出现更大的、核层矫正的基组外推 aCV[DT]Z 不如 aV[DT]Z 的情况。

\begin{figure}[ht]
    \centering
    \caption{$\Delta \alpha_\textsf{D(T)}$ 对体系 \ce{^3O2} 计算结果的基组收敛趋势}
    \label{fig.O2-iso}
    \includegraphics[width=0.5\textwidth]{assets/O2-iso.pdf}
\end{figure}

\textbf{\ce{^3SO} 的基组收敛性。}收敛情况如图 \ref{fig.SO-iso} 所示。对于该体系，我们能看到尽管更大的 aCVDZ 与 aCVTZ 基组本身的表现分别都要好于 aVDZ 与 aVTZ；但 aCV$X$Z 在该体系下收敛速度太快，因此 aCV[DT]Z 反而因为较为激进的 CBS 外推策略，而产生了较大的误差。相比之下，aV$X$Z 的基组收敛趋势与式 (\ref{eq.cbs.zeta3}) 较为接近，因此 aV[DT]Z 的结果很接近精确结果。

\begin{figure}[ht]
    \centering
    \caption{$\Delta \alpha_\textsf{D(T)}$ 对体系 \ce{^3SO} 计算结果的基组收敛趋势}
    \label{fig.SO-iso}
    \includegraphics[width=0.5\textwidth]{assets/SO-iso.pdf}
\end{figure}

\textbf{\ce{Cl2} 的基组收敛性。}收敛情况如图 \ref{fig.Cl2-iso} 所示。该体系的情况与 \ce{^3SO} 有相似之处。其 aCV$X$Z 总体上比 aV$X$Z 的结果要更好，但由于收敛趋势与式 (\ref{eq.cbs.zeta3}) 有一定偏离，因此导致 aCV[TQ]Z 的 CBS 外推误差比 aV[TQ]Z 要更大，并且 aCV[TQ]Z 和 aV[TQ]Z 的误差要比代价更低的 aCV[DT]Z 和 aV[DT]Z 要更大。

\begin{figure}[ht]
    \centering
    \caption{$\Delta \alpha_\textsf{D(T)}$ 对体系 \ce{Cl2} 计算结果的基组收敛趋势}
    \label{fig.Cl2-iso}
    \includegraphics[width=0.5\textwidth]{assets/Cl2-iso.pdf}
\end{figure}

\subsubsection{$\Delta \gamma_\textsf{D(T)}$ 对体系 \ce{^3O2}, \ce{^3SO}, \ce{HCHS}, \ce{Cl2} 计算结果的基组收敛趋势}
\label{sec.5.s5}

\textbf{\ce{^3O2} 的基组收敛性。}自旋极化的分子相比于自旋非极化的分子，在计算异性极化率 $\Delta \gamma_\textsf{D(T)}$ 时，使用较小的基组或 CBS 外推模型，比起同性极化率 $\Delta \alpha_\textsf{D(T)}$ 而言会有更大的误差。这在正文也有说明。该体系的收敛情况如图 \ref{fig.O2-aniso} 所示。对于该体系，我们看到 aVDZ 到 aVTZ 的过程并未真正开始收敛；在此情形下，CBS 外推的 aV[DT]Z 反而造成更严重的误差。

\begin{figure}[ht]
    \centering
    \caption{$\Delta \gamma_\textsf{D(T)}$ 对体系 \ce{^3O2} 计算结果的基组收敛趋势}
    \label{fig.O2-aniso}
    \includegraphics[width=0.5\textwidth]{assets/O2-aniso.pdf}
\end{figure}

\textbf{\ce{^3SO} 的基组收敛性。}收敛情况如图 \ref{fig.SO-aniso} 所示。该体系是非常具有挑战性的体系，因此其基组误差或 CBS 外推误差都不是非常有规律，且误差较大。尽管如此，aCV5Z、aV5Z 或 aV[Q5]Z 的误差都远小于 0.5\%，因此使用这些大小的基组估计 \ce{^3SO} 的异性极化率，仍然是可以接受的。

\begin{figure}[ht]
    \centering
    \caption{$\Delta \gamma_\textsf{D(T)}$ 对体系 \ce{^3SO} 计算结果的基组收敛趋势}
    \label{fig.SO-aniso}
    \includegraphics[width=0.5\textwidth]{assets/SO-aniso.pdf}
\end{figure}

\textbf{\ce{HCHS} 的基组收敛性。}收敛情况如图 \ref{fig.HCHS-aniso} 所示。可以发现该体系下，基组收敛趋势在 QZ (4-$\zeta$) 处出现了剧烈的转折。因此，更昂贵的 aV[TQ]Z、aCV[TQ]Z 外推结果不如 aV[DT]Z、aCV[DT]Z，也不如基组 aVQZ、aCVQZ。

\begin{figure}[ht]
    \centering
    \caption{$\Delta \gamma_\textsf{D(T)}$ 对体系 \ce{HCHS} 计算结果的基组收敛趋势}
    \label{fig.HCHS-aniso}
    \includegraphics[width=0.5\textwidth]{assets/HCHS-aniso.pdf}
\end{figure}

\textbf{\ce{Cl2} 的基组收敛性。}收敛情况如图 \ref{fig.Cl2-aniso} 所示。该体系与 \ce{HCHS} 体系的情况类似，在 QZ (4-$\zeta$) 处 aV$X$Z 的收敛趋势发生了转折；对于 aCV$X$Z 而言，其收敛趋势也与式 (\ref{eq.cbs.zeta3}) 有一定偏离。因此，更昂贵的 CBS 外推，未必比更低等级的外推的误差更小。

\begin{figure}[ht]
    \centering
    \caption{$\Delta \gamma_\textsf{D(T)}$ 对体系 \ce{Cl2} 计算结果的基组收敛趋势}
    \label{fig.Cl2-aniso}
    \includegraphics[width=0.5\textwidth]{assets/Cl2-aniso.pdf}
\end{figure}

\newpage

\bibliographystyle{achemso}
\bibliography{../thesis.bib}

\end{document}