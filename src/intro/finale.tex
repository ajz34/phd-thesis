% !TEX root=./dummy-intro.tex

\chapter{后记}
% \addcontentsline{toc}{chapter}{\normalfont \sffamily 后记}

\section*{论文工作相关}

这里将对正文中一些工作的背景、不足与展望作展开。作为正文的补充，这里并不打算作充分与细致的讨论，但希望可以对后续工作与其他研究者有一定启发。

\subsection*{第 2 章工作相关}

在第 \alertref{sec.2.title} 章中，我们使用了 MP2/cr 方法，针对部分具有挑战性的过渡金属与静态相关计算问题上，提出了 XYG6+1 模型，并对目前流行的 MP2 型双杂化泛函作改进和测评。这里的工作只是往前尝试走的一小步。

在我的认知里，2005 年前后，当 B3LYP、PBE0 等经典近似，被广泛验证并认为对普通有机分子的能量与性质有实用的定量描述时\cite{Koch-Holthausen.Wiley.2001}，计算化学方法开发者们认为可以进一步地尝试更有挑战性的问题。其中两个重要的问题，是弱相互作用与强相互作用问题。

弱相互作用问题通常也称为动态相关问题 (部分讨论该问题的综述如 \citenum{Cremer-Cremer.MP.2001, Cohen-Handy.MP.2001, Handy-Cohen.MP.2001})。由于波函数理论中，MP2 方法通常认为可以有效处理动态相关；而 MP2 相关能在密度泛函中的引入确实有效地解决了弱相互作用计算问题。因此，尽管在 2005 年前后，弱相互作用仍然是具有挑战性的问题；但从现在的眼光来看，该问题至少有了定量的解决方案。

当然，这样的解决方案是否是最优的，这个问题仍然是值得争辩的。MP2 的计算量尽管对于小体系确实可以接受，但对于原子数过百的体系仍然会是负担 (特别是内存开销上)。以低阶泛函结合 DFT-D\cite{Grimme-Krieg.JCP.2010, Smith-Sherrill.JPCL.2016, Caldeweyher-Grimme.JCP.2019}、MBD\cite{Tkatchenko-Scheffler.PRL.2009, Tkatchenko-Scheffler.PRL.2012}、VV10\cite{Vydrov-VanVoorhis.JCP.2010} 为代表的计算量较低的弥散矫正方法也对部分弱相互作用问题有良好的表现 (尽管或许 VV10 在体系较大时才能体现相对较小的计算代价)；这类方法近年仍然有长足的进步，涌现出不少出色的工作\cite{Kirkpatrick-Cohen.S.2021, Liu-He.NCS.2022}。但到目前为止，在以 GMTKN55 为代表的数据集上，这些模型仍然在 WTMAD-2 等测评标准下尚未达到小于 \SI{3}{kcal.mol^{-1}} 的误差。因此，传统的低阶密度泛函以及弥散矫正方法，仍然有发展的空间和需求。

但强相互作用问题，有时也称为静态相关问题\cite{Cremer-Cremer.MP.2001}、左右相关问题\cite{Handy-Cohen.MP.2001, Cohen-Handy.MP.2001}，或化归为分数电荷与自旋问题\cite{Cohen-Yang.S.2008, Cohen-Yang.JCP.2008, Mori-Sanchez-Yang.PRL.2009}，迄今为止尽管有许多模型上的尝试与理论框架的搭建\cite{Hesselmann-Goerling.PRL.2011, Lan-Yanai.JCP.2013, Mezei-Kallay.JCTC.2015, Zhang-Scheffler.NJP.2016, Goerling-Goerling.PRB.2019, Shee-Head-Gordon.JPCL.2021, Zhang-Xu.JPCL.2021, Kirkpatrick-Cohen.S.2021, Santra-Martin.JPCL.2022}；但就我局限的认知，目前还没有一类完美地满足下述所有条件的方法：
\begin{enumerate}[nosep]
    \item 在主要测评集上有良好表现、GMTKN55 数据集的 WTMAD-2 误差小于 \SI{3}{kcal.mol^{-1}}；
    \item 在分子解离问题上，以闭壳层的波函数限制下，不仅可以正确描述近解离趋势、同时在分子解离到无限远处也能给出定量上正确的趋势；
    \item 不直接引入多参考方法，且方法是黑箱的、不需要用户手动指定诸如活性轨道等参数；若要引入多参考信息，其计算复杂度不能是活性轨道数的阶乘或幂次；
    \item 满足正交不变性，不具有自相互作用误差；
    \item 计算量上不显著超过 RI-MP2、且不引入轨道优化 (即不能直接是 OO-MP2 或 CC2 的衍生方法)；
    \item 可以实现梯度性质、并有良好的测评表现。
\end{enumerate}
除此之外，大小一致性必须得到满足。这里 Monte Carlo 方法也算作多参考方法。

以本工作的 XYG6+1/cr 为例。上述第 1 点尽管比较乐观，但目前还未完整地经受 GMTKN55 以外数据集下完整的测评。第 2 点就算是对普通双杂化或低阶泛函有少许改进，但显然不算达成了目标。第 4 点上正交不变性也有少许缺陷；自相互作用误差不可能严格为零，但由于 $E_\textmt{x}^\textmt{exact}$ 在 XYG6+1/cr 中占比为相当大的 0.85、而 MP2/cr 与 MP2 作为相关能也都不具有自相互误差，因此预期自相互作用误差较小。第 6 点尽管也相对乐观，但 MP2 衍生方法经常不满足正交不变性，而这又进一步地会遇到轨道近简并情况下梯度数值不稳定的问题 (即附录 \alertref{sec.3.non-canonical-mp2-gradient} 的结论与程序实现策略无法适用于 MP2/cr 或 IEPA 等方法；数值梯度也可能会遇到问题)。

除了上述的困难，准确参考值数据的获得也存在一些困难。多参考方法被认为可以很好地解决静态相关问题，但同时其动态相关的描述存在困难、或者程序实现存在一定的不稳定性。多参考方法本身的计算复杂度已经很高，在其之上的微扰理论的计算代价更是一般有机化学体系难以接受的\cite{Finley-Serrano-Andres.CPL.1998, Angeli-Malrieu.JCP.2001, Angeli-Malrieu.CPL.2001, Malmqvist-Gagliardi.JCP.2008, Pulay-Pulay.IJQC.2011}。即使是相当高精度的多参考方法，也可能对一些简单的模型体系无法很好地正常描述\cite{Vancoillie-Veryazov.JCTC.2016}。在计算设备沿着 Moore 定律发展的今天，也有科研工作者看到多参考方法应用于实际问题的希望，在降低计算量、拓展多参考方法应用场景上\cite{Ren-Shuai.WCMS.2022, Li-Chen.PRR.2022, Xiang-Li.JCTC.2024}，或对多参考方法引入动态相关的方式上作改进\cite{Mitra-Gagliardi.JCTC.2023, Feng-Xu.chemRxiv.2023}，有不少出色的工作。

密度泛函理论与近似的发展与流行，始终与其计算量较低有关；双杂化泛函之所以有潜力成为未来计算化学应用的主力，我相信很大程度上也是因为 Moore 定律下计算容量的发展、以及存在高效的近似计算策略\cite{Almloef-Almloef.CPL.1991, Weigend-Ahlrichs.CPL.1998, Hohenstein-Martinez.JCP.2012, Parrish-Sherrill.JCP.2012}。对于低阶泛函，作为自洽场方法额外地，其梯度与激发态性质容易实现，因而可以在较少的计算量、以及与 Hartree-Fock 相似的程序框架下，实现大量的固体物质、精细光谱模拟 (这或许也是双杂化泛函作为非变分泛函的缺点、以及其亟待解决的问题)。因此，从我的视角出发，若多参考方法在不超过 100 原子的 3-$\zeta$ 基组下，能与低阶或双杂化密度泛函近似有同一水平的计算代价；那么在当下，在密度泛函中引入多参考方法、并将其成规模地应用于实际问题的时机可能不太成熟。但从另一个角度看，Kohn-Sham 定理在能级并不真的简并的前提下，仍然是严格的；而 Kohn-Sham 方程必然可以导出单参考波函数也能描述的电子云密度。因此，如何在 Kohn-Sham 框架或与之接近的框架下，有效解决静态相关问题，还是值得研究的问题。尽管相信很困难，但如果这个思路上能有所突破，那么就有希望在较少的计算量下解决静态相关问题。不论解决这一问题的最终路径，是通过第一性理论推演、还是大数据学习，更快地、更高通量的高精度多参考方法数据总是有帮助的。因此，我也很期待多参考方法的长足发展。

\subsection*{附录 A 工作相关}

附录 \alertref{sec.3.title} 中，我们实现了 RI 近似下 DH，特别是 xDH 的静态极化率计算，并尽可能地将程序框架做到可以扩展其他相关形式的泛函。

这是就读期间耗费最多精力的课题；尽管如此，到目前为止，相对于其他科研工作者、或已经发表的工作，这份工作还没有新的突破；不管是功能、易用与易扩展程度、甚至是效率上，都还称不上是新的突破。

之所以会想到踏入计算化学的领域，我想 Dirac 的话语起到过相当程度的影响\cite{Dirac-Dirac.PRSLA.1929}：
\begin{quotation}
    \it
    The underlying physical laws necessary for the mathematical theory of a large part of physics and the whole of chemistry are thus completely known, and the difficulty is only that the exact application of these laws leads to equations much too complicated to be soluble.
\end{quotation}
这句话写在了各种教科书中，相信这句话也影响过许多人；不论是学生，或是编写教科书的前辈们。尽管现在想来，这些话语背后，还意味着新的物理与化学现象在当时尚未发现；但如果只是关注物质的运动方程与状态函数，那么如何有效地数值模拟，便是最重要的技术问题。回想到这篇论文的工作，回想到附录 \alertref{sec.3.title} 冗长的文段；我总觉得希望讲些什么，希望把一些东西讲清楚；但这样的冲动显然不应有我潜意识里所期望的价值，因为若要问它带来了什么，为计算化学理论带来了哪些新的认识和简化，为大众对化学现象的认识带来了哪些提升，我发现给不出令人满意的说辞。起笔论文的时候，我没有注意到编写当时还是正文内容的附录 \alertref{sec.3.title} 的动机；但最终，我认为附录 \alertref{sec.3.title} 的内容是想要表达，就算没有成果，曾经在这个问题上也有普通人的努力。像这样仅仅是宣泄情绪的文段，或许不应出现在论文中；但不忍删去，遂将其从论文起笔时的正文拉入最终的附录。

技术的进步确实是重要的。最近几年，以深度网络为代表的机器学习与人工智能方法盛行；其大背景或许就是 Moore 定律发展到了计算能力与潜力快速超过基于演绎的知识的时代，以至于人们可以依赖于具体计算过程不那么具象的参数化模型。我不清楚是否这两件事是有关联的：计算化学非常深地依赖于张量运算；而机器学习的兴起将张量运算带入了新的高度，理论上与效率上兼有。后者或许意外地有潜力推动所有以张量计算为基础的学科。算子融合、内存墙、缓存局域优化、Roofline 等等概念，已经渐渐地成为机器学习效率优化的常见技术或关心的问题；高效的矩阵乘法库函数实现也越来越便利\cite{vanZee-vandeGeijn.ATMS.2015}、以至于高效的任意张量乘法的实现也成为可能\cite{Matthews-Matthews.SJSC.2018}。将来的计算化学程序或许将会越来越重视这些因机器学习而起、或受机器学习发展而带动的工程经验。

同时，开源社区的兴起也对计算化学程序有相当大的改观。化学领域有一些开源项目，以高效库函数的方式实现了底层的算法与功能\cite{Valeyev.libint, Lehtola-Marques.S.2018, Sun-Sun.JCC.2015}，解放了许多计算化学工作者，让他们更加专注于顶层的算法设计。但同时，中层涉及到张量运算的部分，大多数程序仍然将其作为关键的业务逻辑实现；但实际上，这类张量运算程序，对于功能不同的软件，通常又有相当程度的共通部分、或者说有不少比较同质化的部分。我不清楚这会不会是不切实际的愿望，但未来或许会有一种类似于 LAPACK 的标准，在计算化学程序上更进一步地拆分业务逻辑与需要高效实现的中层算法，以更大程度上地解放方法开发者在程序设计上的开发效率。

\textsc{PySCF} 提供了一种相当有意思的思路与具体实现，它将业务逻辑关键部分以 \textsc{Python} 实现、而拆分出效率关键部分以 C 实现\cite{Sun-Chan.WCMS.2018, Sun-Chan.JCP.2020}；基于此，本工作的项目得以使用纯 \textsc{Python}，也可以给出优于其他计算化学程序的效率。我本人非常感激有 \textsc{PySCF} 与 \textsc{Psi4} 等项目的存在：尽管机器学习中有 \textsc{Tensorflow} 与 \textsc{Pytorch} 的巨大成功，使得 \textsc{Python/C} 混合高效编程成为必然可以实现的工程实践；但真的存在开源项目将其成功实现，并不见得是历史的必然。但在具体工程实现上，我自己也确实遇到过基于 \textsc{Python} 的程序存在效率瓶颈的问题；这也使得即使当前工作的 RI-MP2 极化率就算效率比其他程序高，也未必比数值梯度快的重要缺陷。这导致本工作程序的唯一特色是，解析梯度的数值精度与稳定性比数值梯度高。一定程度上，也是因为考虑到此，我认为附录 \alertref{sec.3.title} 的工作应当看做是未完成的；需要承认，这受能力所限、也受精力所限。

除此之外，现在已经有众多的异于 RI-MP2 的低计算复杂度加速算法，包括但不限于 Laplace-Transform\cite{Almloef-Almloef.CPL.1991}、ISDF\cite{Dong-Lin.JCTC.2018, Qin-Yang.JPCA.2020}、Local RI\cite{Ihrig-Blum.NJP.2015}、DLPNO\cite{Riplinger-Neese.JCP.2013, Pinski-Neese.JCP.2015}。这些算法在梯度性质上是否也有效率上显著的突破、这些算法的提升极限是多少、如何实现这些算法、如何在广泛的 DH 框架下应用这些算法，也是这份工作所没能完成的遗憾、以及将来有必要解决的课题。
